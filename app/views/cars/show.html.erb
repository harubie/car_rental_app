<div class="max-w-4xl mx-auto p-6">
  <!-- Title -->
  <h1 class="text-2xl font-bold mb-1"><%= @car.title %></h1>
  <p class="text-gray-600 mb-6"><%= @car.year %> <%= @car.brand %> <%= @car.model %></p>

  <!-- Photo -->
  <div class="mb-6">
    <% if @car.photo.attached? %>
      <%= cl_image_tag @car.photo.key, height: 400, width: 600, class: "w-full rounded-lg object-cover" %>
    <% else %>
      <div class="flex items-center justify-center h-64 bg-gray-100 rounded-lg">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-16 h-16 text-gray-400">
          <path d="M.97 3.97a.75.75 0 0 1 1.06 0l15 15a.75.75 0 1 1-1.06 1.06l-15-15a.75.75 0 0 1 0-1.06ZM17.25 16.06l2.69 2.69c.944.945 2.56.276 2.56-1.06V6.31c0-1.336-1.616-2.005-2.56-1.06l-2.69 2.69v8.12ZM15.75 7.5v8.068L4.682 4.5h8.068a3 3 0 0 1 3 3ZM1.5 16.5V7.682l11.773 11.773c-.17.03-.345.045-.523.045H4.5a3 3 0 0 1-3-3Z" />
        </svg>
      </div>
    <% end %>
  </div>

  <!-- Details -->
  <div class="mb-6 p-4 border border-gray-200 rounded-lg">
    <p class="mb-2"><span class="text-gray-600">Seats:</span> <%= @car.seats %></p>
    <p class="mb-2"><span class="text-gray-600">Price per day:</span> $<%= @car.price_per_day %></p>
    <p><span class="text-gray-600">Address:</span> <%= @car.address %></p>
  </div>

  <!-- Map -->
  <div class="mb-6">
    <h3 class="text-lg font-semibold mb-3">Location</h3>
    <div data-controller="show-map"
         data-show-map-api-key-value="<%= ENV["MAPBOX_API_KEY"] %>"
         data-show-map-latitude-value="<%= @car.latitude %>"
         data-show-map-longitude-value="<%= @car.longitude %>"
         class="h-64 w-full rounded-lg border border-gray-200 overflow-hidden">
    </div>
  </div>

  <!-- Actions -->
  <% if current_user == @car.user %>
    <div class="flex gap-3">
      <%= link_to "Delete Car", car_path(@car),
          data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this car?" },
          class: "text-red-600 border border-red-600 px-4 py-2 rounded hover:bg-red-50" %>
      <%= link_to "Back to home", root_path, class: "text-gray-600 hover:text-gray-800" %>
    </div>
  <% else %>
    <!-- Booking Form -->
    <div class="p-6 border border-gray-200 rounded-lg mb-6">
      <h3 class="text-lg font-semibold mb-4">Book this car</h3>
      <%= form_with model: [@car, @booking], local: true do |f| %>
        <div class="space-y-4">
          <div>
            <%= f.label :start_date, "Start Date", class: "block text-sm text-gray-700 mb-1" %>
            <%= f.date_field :start_date, class: "block w-full border border-gray-300 rounded px-3 py-2" %>
          </div>

          <div>
            <%= f.label :end_date, "End Date", class: "block text-sm text-gray-700 mb-1" %>
            <%= f.date_field :end_date, class: "block w-full border border-gray-300 rounded px-3 py-2" %>
          </div>

          <div class="flex gap-3 pt-2 justify-end items-center">
            <%= link_to "Back", root_path, class: "text-sm font-semibold text-gray-600 hover:text-gray-800" %>
            <%= f.submit "Book Now", class: "rounded-md bg-indigo-500 px-6 py-2 text-sm font-semibold text-white hover:bg-indigo-600" %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
